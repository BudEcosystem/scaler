---
# Example: KPA Strategy - KNative-style Pod Autoscaling
# Uses panic and stable windows for responsive scaling
apiVersion: scaler.bud.studio/v1alpha1
kind: BudAIScaler
metadata:
  name: api-gateway-kpa
  namespace: default
  annotations:
    # KPA-specific tuning
    scaler.bud.studio/panic-threshold: "200"  # Enter panic mode at 200% of target
    scaler.bud.studio/panic-window: "60"      # 60 second panic window
    scaler.bud.studio/stable-window: "180"    # 3 minute stable window
spec:
  scaleTargetRef:
    apiVersion: apps/v1
    kind: Deployment
    name: api-gateway
  minReplicas: 1
  maxReplicas: 20
  scalingStrategy: KPA
  metricsSources:
    - metricSourceType: pod
      targetMetric: requests_per_second
      targetValue: "100"
      port: "8080"
      path: /metrics
  behavior:
    scaleUp:
      stabilizationWindowSeconds: 0  # Immediate scale up for KPA
    scaleDown:
      stabilizationWindowSeconds: 300
